<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Списъци и макроси</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2002-2003 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">

<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif">
<p>
[<a href="config.html">Преди: Конфигуриране</a>]
[<a href="index.html">Съдържание</a>]
[<a href="tables.html">Следва: Таблици</a>]

<h1><font color="#e00000">PF: Списъци и макроси</font></h1>
<hr>

<h3>Съдържание</h3>
<ul>
<li><a href="#lists">Списъци</a>
<li><a href="#macros">Макроси</a>
</ul>

<hr>

<a name="lists"></a>
<h2>Списъци</h2>
Списъка позволява задаване на няколко, близки по критерий неща, в едно
правило. Например, множество протоколи, номера на портове, адреси и т.н.
Така например, вместо да бъде въвеждано отделно правило за всеки адрес,
които трябва да се блокира, може да се въведе едно правило, в което IP
адресите да бъдат зададени със списък. Списъците са дефинирани, като
стойностти, заградени в скоби от вида  <tt>{ }</tt>.

<p>
Когато
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3"
>pfctl(8)</a>, по време на зареждането на ruleset, разпознае списък, 
той създава множество правила, по едно за всяка стойност в списъка.
Например:
<blockquote>
<tt>
block out on fxp0 from { 192.168.0.1, 10.5.32.6 } to any
</tt>
</blockquote>

<p>
ще бъде разгърнато до:
<blockquote>
<tt>
block out on fxp0 from 192.168.0.1 to any<br>
block out on fxp0 from 10.5.32.6 to any
</tt>
</blockquote>

<p>
В едно правило може да има няколко списъка. Самото правило може да не
се отнася изобщо за филтриране:
<blockquote>
<tt>
rdr on fxp0 proto tcp from any to any port { 22 80 } -&gt; \<br>
&nbsp;&nbsp;&nbsp;192.168.0.6<br>
block out on fxp0 proto { tcp udp } from { 192.168.0.1, \<br> 
&nbsp;&nbsp;&nbsp;10.5.32.6 } to any port { ssh telnet }
</tt>
</blockquote>

<p>
Запетайките между отделните стойностти не са задължителни.

<a name="macros"></a>
<h2>Макроси</h2>
Макросите са дефинирани от потребителя променливи, които могат да
съдържат IP адреси, номера на портове, имена на интерфейси и т.н.
Макросите могат да упростят PF rulesets и да улеснят подръжката им.

<p>
Имената на макроси трябва да започват с буква, и могат да съдържат букви,
цифри и знак за подчертаване (_). Имената не макроси не могат да бъдат
запазени думи от вида <tt>pass</tt>, <tt>out</tt>, <tt>queue</tt> и т.н.
<blockquote>
<tt>
ext_if = "fxp0"<br>
<br>
block in on $ext_if from any to any<br>
</tt>
</blockquote>

<p>
Примера по-горе създава макро с име <tt>ext_if</tt>. 
Когато макро се използва след дефинирането му, неговото име се предхожда от
символ <tt>$</tt>.

<p>
Списъци също могат да бъдат дефинирани с макроси:
<blockquote>
<tt>
friends = "{ 192.168.1.1, 10.0.2.5, 192.168.43.53 }"
</tt>
</blockquote>

<p>
Макроси могат да бъдат дефинирани рекурсивно. Поради това, че макроси не
се разгръщат, ако са в кавички, може да се използва следния синтаксис:
<blockquote>
<tt>
host1      = "192.168.1.1"<br>
host2      = "192.168.1.2"<br>
all_hosts  = "{" $host1 $host2 "}"<br>
</tt>
</blockquote>

<p>
Така <tt>$all_hosts</tt> макро ще бъде разгърнато до 192.168.1.1, 192.168.1.2.

<p>
[<a href="config.html">Преди: Конфигуриране</a>]
[<a href="index.html">Съдържание</a>]
[<a href="tables.html">Следва: Таблици</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Оригинал: [ OpenBSD: macros.html,v 1.4 2003/06/13 02:54:08 nick Exp ]<br>
$BgOBSD$<br>
$Translation$<br>
$OpenBSD$
</small>

</body>
</html> 
