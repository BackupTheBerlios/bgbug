<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Конфигуриране</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2003 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif">
<p>
[<a href="index.html">Съдържание</a>]
[<a href="macros.html">Следва: Списъци и макроси</a>]

<p>
<h1><font color="#e00000">PF: Конфигуриране</font></h1>

<hr>

<h3>Съдържание</h3>
<ul>
<li><a href="#activate">Активиране</a>
<li><a href="#config">Конфигуриране</a>
<li><a href="#control">Контрол</a>
</ul>

<hr>

<a name="activate"></a>
<h2>Активиране</h2>
За да активирате PF и той за прочете конфигурационния файл по време на 
първоначалното зареждане (boot), редактирайте файла 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8&amp;manpath=OpenBSD+3.3"
><tt>/etc/rc.conf</tt></a>, така, че реда за PF да бъде:

<blockquote>
<tt>
pf=YES
</tt>
</blockquote>

<p>
Рестартирайте системата за да имат ефект промените.

<p>
Освен това може да активиране и деактивирате PF с използването на програмата
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3"
>pfctl(8)</a>:

<blockquote>
<tt>
# pfctl -e<br>
# pfctl -d
</tt>
</blockquote>

<p>
съответно за активиране и деактивиране.
Забележете, че това само разрешава или забранява PF, но всъщност не
зарежда правилата (rulesets). Те трябва да бъдат заредени отделно, преди
или след като PF е разрешен.

<a name="config"></a>
<h2>Конфигуриране</h2>
<p>
PF прочита правилата за конфигуриране от
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.3"
><tt>/etc/pf.conf</tt></a> по време на първоначалното зареждане (boot), както
е определено от 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8&amp;manpath=OpenBSD+3.3"
>rc scripts</a>. забележете, че макар 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.3"
><tt>/etc/pf.conf</tt></a> да е файла по подразбиране, зареждан от системните
rc scripts, това си е всъщност обикновен текстов файл, зареждан и интерпретиран
от програмата 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3"
>pfctl(8)</a>, която го въвежда в 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.3"
>pf(4)</a>. Т.е. за други приложения, различни набори от правила (rulesets)
могат да бъдат заредени от други конфигурационни файлове. Както всички добре
проектирани Unix приложения, PF също предлага изключителна гъвкавост.

<p>
<tt>pf.conf</tt> файла се състои от седем части:
<ul>
<li><b><a href="macros.html">Макроси:</a></b> дефинирани от потребителя
променливи, които съдържат IP адреси, имена на интерфейси и т.н.
<li><b><a href="tables.html">Таблици:</a></b> структури, използвани специално
за съхранение на списъци от IP адреси.
<li><b><a href="options.html">Параметри:</a></b> различни параметри,
контролиращи работата на PF.
<li><b><a href="scrub.html">Пречистване (Scrub):</a></b> предварителна 
обработка на пакетите за нормализацията и дефрагментирането им.
<li><b><a href="queueing.html">Queueing:</a></b> осигурява bandwidth контрол
и приоритизация на пакетите.
<li><b><a href="nat.html">Трансформация:</a></b> контролира преобразуването
на мрежовия адрес (NAT) и <a href="rdr.html">пренасочването на пакети</a>.

<li><b><a href="filter.html">Правила за филтриране:</a></b> позволява
селективно да се филтрират или блокират пакети докато те преминават през
дадени интерфейси.
</ul>

<p>
С изключение на <b>macros</b> и <b>tables</b>, всички останали секции трябва
да бъдат подредени в този ред в конфигурационния файл. Не е задължително
обаче всички секции да присъстват за всяко специфично приложение.

<p>
Празните редове се игнорират и редовете, започващи с <tt>#</tt> се смятат
за коментари. 

<a name="control"></a>
<h2>Контрол</h2>
След началното зареждане, действието на PF може да се управлява с използването
на програмата
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3"
>pfctl(8)</a>. Някои примерни команди:

<pre>
     # pfctl -f /etc/pf.conf     <i>зарежда файла pf.conf</i>
     # pfctl -nf /etc/pf.conf    <i>проверява синтаксиса на файла, но не го зарежда</i>
     # pfctl -Nf /etc/pf.conf    <i>Зарежда само NAT правилата от файла</i>
     # pfctl -Rf /etc/pf.conf    <i>Зарежда само правилата за филтриране от файла</i>

     # pfctl -sn                 <i>Показва текущите NAT правила</i> 
     # pfctl -sr                 <i>Показва текущите правила за филтриране</i>
     # pfctl -ss                 <i>Показва текущата таблица на състоянията</i>
     # pfctl -si                 <i>Показва статистики за филтрирането и броячи</i>
     # pfctl -sa                 <i>Показва ВСИЧКО, което може да се покаже</i>
</pre>

<p>
За пълният списък с команди, моля погледнете 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3"
>man страницата за pfctl(8)</a>.

<p>
[<a href="index.html">Съдържание</a>]
[<a href="macros.html">Следва: Списъци и макроси</a>]


<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Оригинал: [ OpenBSD: config.html,v 1.5 2003/06/13 02:54:08 nick Exp ]<br>
$BgOBSD$<br>
$Translation$<br>
$OpenBSD$
</small>

</body>
</html> 
